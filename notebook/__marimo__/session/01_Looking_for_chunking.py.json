{
  "version": "1",
  "metadata": {
    "marimo_version": "0.18.4"
  },
  "cells": [
    {
      "id": "Hbol",
      "code_hash": "9d86fe3bd37c1612b9fa58e491484048",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "MJUe",
      "code_hash": "45eca83c15958557885dfa35e80407e4",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "Unexpected Response: 404 (Not Found)\nRaw response content:\nb'{\"status\":{\"error\":\"Not found: Collection `appalti_chunks` doesn\\'t exist!\"},\"time\":7e-6}'",
          "traceback": []
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "<span class=\"codehilite\"><div class=\"highlight\"><pre><span></span><span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;/var/folders/qh/9x5mw6kn1kv7c9wtrmx21f6h0000gn/T/marimo_22416/__marimo__cell_MJUe_.py&quot;</span>, line <span class=\"m\">15</span>, in <span class=\"n\">&lt;module&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">vector_store</span> <span class=\"o\">=</span> <span class=\"n\">QdrantVectorStore</span><span class=\"p\">(</span><span class=\"n\">client</span><span class=\"o\">=</span><span class=\"n\">qclient</span><span class=\"p\">,</span> <span class=\"n\">embedding_model</span><span class=\"o\">=</span><span class=\"n\">embedding_model</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/src/appaltigpt/chunkizer/adapters/qdrant_vector_store.py&quot;</span>, line <span class=\"m\">17</span>, in <span class=\"n\">__init__</span>\n<span class=\"w\">    </span><span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">client</span><span class=\"o\">.</span><span class=\"n\">collection_exists</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">collection_name</span><span class=\"p\">)</span> <span class=\"ow\">and</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">embedding_model</span><span class=\"o\">.</span><span class=\"n\">model_size</span> <span class=\"o\">==</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">client</span><span class=\"o\">.</span><span class=\"n\">get_collection</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">collection_name</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">vectors_config</span><span class=\"o\">.</span><span class=\"n\">size</span><span class=\"p\">:</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/qdrant_client/qdrant_client.py&quot;</span>, line <span class=\"m\">1534</span>, in <span class=\"n\">get_collection</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_client</span><span class=\"o\">.</span><span class=\"n\">get_collection</span><span class=\"p\">(</span><span class=\"n\">collection_name</span><span class=\"o\">=</span><span class=\"n\">collection_name</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/qdrant_client/qdrant_remote.py&quot;</span>, line <span class=\"m\">1799</span>, in <span class=\"n\">get_collection</span>\n<span class=\"w\">    </span><span class=\"n\">result</span><span class=\"p\">:</span> <span class=\"n\">types</span><span class=\"o\">.</span><span class=\"n\">CollectionInfo</span> <span class=\"o\">|</span> <span class=\"kc\">None</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">http</span><span class=\"o\">.</span><span class=\"n\">collections_api</span><span class=\"o\">.</span><span class=\"n\">get_collection</span><span class=\"p\">(</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/qdrant_client/http/api/collections_api.py&quot;</span>, line <span class=\"m\">320</span>, in <span class=\"n\">get_collection</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_build_for_get_collection</span><span class=\"p\">(</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/qdrant_client/http/api/collections_api.py&quot;</span>, line <span class=\"m\">144</span>, in <span class=\"n\">_build_for_get_collection</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">api_client</span><span class=\"o\">.</span><span class=\"n\">request</span><span class=\"p\">(</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/qdrant_client/http/api_client.py&quot;</span>, line <span class=\"m\">95</span>, in <span class=\"n\">request</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">send</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"n\">type_</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/qdrant_client/http/api_client.py&quot;</span>, line <span class=\"m\">130</span>, in <span class=\"n\">send</span>\n<span class=\"w\">    </span><span class=\"k\">raise</span> <span class=\"n\">UnexpectedResponse</span><span class=\"o\">.</span><span class=\"n\">for_response</span><span class=\"p\">(</span><span class=\"n\">response</span><span class=\"p\">)</span>\n<span class=\"gr\">qdrant_client.http.exceptions.UnexpectedResponse</span>: <span class=\"n\">Unexpected Response: 404 (Not Found)</span>\n<span class=\"x\">Raw response content:</span>\n<span class=\"x\">b&#39;{&quot;status&quot;:{&quot;error&quot;:&quot;Not found: Collection `appalti_chunks` doesn\\&#39;t exist!&quot;},&quot;time&quot;:7e-6}&#39;</span>\n</pre></div>\n</span>",
          "mimetype": "application/vnd.marimo+traceback"
        }
      ]
    },
    {
      "id": "vblA",
      "code_hash": "07f711bceef80d14b4b5fdff7725c6f6",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "This cell raised an exception: CancelledError",
          "traceback": []
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Converting documents...\nAnalyzing DISCIPLINARE_DI_GARA_RETTIFICATO.pdf (55 pages)...\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "<span class=\"codehilite\"><div class=\"highlight\"><pre><span></span><span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/openai/_base_client.py&quot;</span>, line <span class=\"m\">1532</span>, in <span class=\"n\">request</span>\n<span class=\"w\">    </span><span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_client</span><span class=\"o\">.</span><span class=\"n\">send</span><span class=\"p\">(</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/httpx/_client.py&quot;</span>, line <span class=\"m\">1629</span>, in <span class=\"n\">send</span>\n<span class=\"w\">    </span><span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_send_handling_auth</span><span class=\"p\">(</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/httpx/_client.py&quot;</span>, line <span class=\"m\">1657</span>, in <span class=\"n\">_send_handling_auth</span>\n<span class=\"w\">    </span><span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_send_handling_redirects</span><span class=\"p\">(</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/httpx/_client.py&quot;</span>, line <span class=\"m\">1694</span>, in <span class=\"n\">_send_handling_redirects</span>\n<span class=\"w\">    </span><span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_send_single_request</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/httpx/_client.py&quot;</span>, line <span class=\"m\">1730</span>, in <span class=\"n\">_send_single_request</span>\n<span class=\"w\">    </span><span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"n\">transport</span><span class=\"o\">.</span><span class=\"n\">handle_async_request</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/httpx/_transports/default.py&quot;</span>, line <span class=\"m\">394</span>, in <span class=\"n\">handle_async_request</span>\n<span class=\"w\">    </span><span class=\"n\">resp</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_pool</span><span class=\"o\">.</span><span class=\"n\">handle_async_request</span><span class=\"p\">(</span><span class=\"n\">req</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/httpcore/_async/connection_pool.py&quot;</span>, line <span class=\"m\">256</span>, in <span class=\"n\">handle_async_request</span>\n<span class=\"w\">    </span><span class=\"k\">raise</span> <span class=\"n\">exc</span> <span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"kc\">None</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/httpcore/_async/connection_pool.py&quot;</span>, line <span class=\"m\">236</span>, in <span class=\"n\">handle_async_request</span>\n<span class=\"w\">    </span><span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"n\">connection</span><span class=\"o\">.</span><span class=\"n\">handle_async_request</span><span class=\"p\">(</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/httpcore/_async/connection.py&quot;</span>, line <span class=\"m\">103</span>, in <span class=\"n\">handle_async_request</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"k\">await</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_connection</span><span class=\"o\">.</span><span class=\"n\">handle_async_request</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/httpcore/_async/http11.py&quot;</span>, line <span class=\"m\">136</span>, in <span class=\"n\">handle_async_request</span>\n<span class=\"w\">    </span><span class=\"k\">raise</span> <span class=\"n\">exc</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/httpcore/_async/http11.py&quot;</span>, line <span class=\"m\">106</span>, in <span class=\"n\">handle_async_request</span>\n<span class=\"w\">    </span><span class=\"p\">)</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_receive_response_headers</span><span class=\"p\">(</span><span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/httpcore/_async/http11.py&quot;</span>, line <span class=\"m\">177</span>, in <span class=\"n\">_receive_response_headers</span>\n<span class=\"w\">    </span><span class=\"n\">event</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_receive_event</span><span class=\"p\">(</span><span class=\"n\">timeout</span><span class=\"o\">=</span><span class=\"n\">timeout</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/httpcore/_async/http11.py&quot;</span>, line <span class=\"m\">217</span>, in <span class=\"n\">_receive_event</span>\n<span class=\"w\">    </span><span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_network_stream</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">(</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/httpcore/_backends/anyio.py&quot;</span>, line <span class=\"m\">35</span>, in <span class=\"n\">read</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"k\">await</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_stream</span><span class=\"o\">.</span><span class=\"n\">receive</span><span class=\"p\">(</span><span class=\"n\">max_bytes</span><span class=\"o\">=</span><span class=\"n\">max_bytes</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/anyio/streams/tls.py&quot;</span>, line <span class=\"m\">244</span>, in <span class=\"n\">receive</span>\n<span class=\"w\">    </span><span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_call_sslobject_method</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_ssl_object</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">,</span> <span class=\"n\">max_bytes</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/anyio/streams/tls.py&quot;</span>, line <span class=\"m\">187</span>, in <span class=\"n\">_call_sslobject_method</span>\n<span class=\"w\">    </span><span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">transport_stream</span><span class=\"o\">.</span><span class=\"n\">receive</span><span class=\"p\">()</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/anyio/_backends/_asyncio.py&quot;</span>, line <span class=\"m\">1292</span>, in <span class=\"n\">receive</span>\n<span class=\"w\">    </span><span class=\"k\">await</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_protocol</span><span class=\"o\">.</span><span class=\"n\">read_event</span><span class=\"o\">.</span><span class=\"n\">wait</span><span class=\"p\">()</span>\n  File <span class=\"nb\">&quot;/Users/carlo/.local/share/uv/python/cpython-3.10.16-macos-aarch64-none/lib/python3.10/asyncio/locks.py&quot;</span>, line <span class=\"m\">214</span>, in <span class=\"n\">wait</span>\n<span class=\"w\">    </span><span class=\"k\">await</span> <span class=\"n\">fut</span>\n<span class=\"gr\">asyncio.exceptions.CancelledError</span>\n\n<span class=\"gt\">During handling of the above exception, another exception occurred:</span>\n\n<span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/.venv/lib/python3.10/site-packages/marimo/_runtime/executor.py&quot;</span>, line <span class=\"m\">112</span>, in <span class=\"n\">execute_cell_async</span>\n<span class=\"w\">    </span><span class=\"k\">await</span> <span class=\"nb\">eval</span><span class=\"p\">(</span><span class=\"n\">cell</span><span class=\"o\">.</span><span class=\"n\">body</span><span class=\"p\">,</span> <span class=\"n\">glbls</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/var/folders/qh/9x5mw6kn1kv7c9wtrmx21f6h0000gn/T/marimo_22416/__marimo__cell_vblA_.py&quot;</span>, line <span class=\"m\">1</span>, in <span class=\"n\">&lt;module&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">results</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"n\">service</span><span class=\"o\">.</span><span class=\"n\">process_documents</span><span class=\"p\">(</span><span class=\"n\">DOCS_FOLDER</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/carlo/Desktop/SideQuests/AppaltiGPT/src/appaltigpt/chunkizer/services/chunking.py&quot;</span>, line <span class=\"m\">107</span>, in <span class=\"n\">process_documents</span>\n<span class=\"w\">    </span><span class=\"n\">batch_analyses</span><span class=\"p\">:</span> <span class=\"n\">List</span><span class=\"p\">[</span><span class=\"n\">RagAnalysis</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"n\">asyncio</span><span class=\"o\">.</span><span class=\"n\">gather</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">analysis_tasks</span><span class=\"p\">)</span>\n<span class=\"gr\">asyncio.exceptions.CancelledError</span>\n</pre></div>\n</span>",
          "mimetype": "application/vnd.marimo+traceback"
        }
      ]
    },
    {
      "id": "bkHC",
      "code_hash": "3fb809c5e1642934b389d155a2d5cdbd",
      "outputs": [],
      "console": []
    },
    {
      "id": "lEQa",
      "code_hash": "8aa94840141ad56dffd4766269ae44b1",
      "outputs": [],
      "console": []
    }
  ]
}